Original implementation by Bernhard Schmitzer and Mauro Bonafini
